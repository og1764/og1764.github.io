// Front Facing Config. Aliases are when there are multiple names for the one venue.
// Also need to add those aliases / new venues to ~ line 466

// VENUE_SPLIT should show how to parse every venue that is shown ON BRACKETPAL
// __CONFIG__ is used for front end to braketpal parse.
const __CONFIG__ = {
    "venues": [{
            "name": "Aquinas",
            "top": "",
            "mid": "Aquinas",
            "bot": "College",
            "alias": ["Aquinas College"]
        },
        {
            "name": "Ballajura",
            "top": "",
            "mid": "",
            "bot": "Ballajura",
            "alias": ["Ballajura Indoor Spo"]
        },
        {
            "name": "Bendat",
            "top": "",
            "mid": "",
            "bot": "Bendat",
            "alias": []
        },
        {
            "name": "Cockburn",
            "top": "",
            "mid": "",
            "bot": "Cockburn",
            "alias": ["Cockburn ARC"]
        },
        {
            "name": "Curtin Stadium",
            "top": "",
            "mid": "Curtin",
            "bot": "Stadium",
            "alias": ["Curtin"]
        },
        {
            "name": "ECU Mt. Lawley",
            "top": "",
            "mid": "ECU",
            "bot": "Mt. Lawley",
            "alias": ["ECU", "ECU Mount Lawley", "ECU Mt Lawley"]
        },
        {
            "name": "Geographe Leisure Centre",
            "top": "Geographe",
            "mid": "Leisure",
            "bot": "Centre",
            "alias": ["Geographe", "Geographe Leisure", "Geographe Lei. Centr"]
        },
        {
            "name": "Gold Netball Centre",
            "top": "Gold",
            "mid": "Netball",
            "bot": "Centre",
            "alias": []
        },
        {
            "name": "Greenwood College",
            "top": "",
            "mid": "Greenwood",
            "bot": "College",
            "alias": []
        },
        {
            "name": "Hale",
            "top": "",
            "mid": "",
            "bot": "Hale",
            "alias": []
        },
        {
            "name": "Halls Head Recreation Centre",
            "top": "Halls Head",
            "mid": "Recreation",
            "bot": "Centre",
            "alias": ["Halls Head Rec Centr", "Halls Head Rec"]
        },
        {
            "name": "HBF Stadium Claremont",
            "top": "",
            "mid": "HBF",
            "bot": "Stadium",
            "alias": ["HBF Stad. Claremont", "HBF", "HBF Stadium", "HBF Stad."]
        },
        {
            "name": "John Wollaston",
            "top": "",
            "mid": "John",
            "bot": "Wollaston",
            "alias": ["John Wollaston ACS C", "John Wollaston ACS",]
        },
        {
            "name": "Kingsway",
            "top": "",
            "mid": "",
            "bot": "Kingsway",
            "alias": ["Kingsway Indoor Stad", "Kingsway Indoor"]
        },
        {
            "name": "Loftus",
            "top": "",
            "mid": "",
            "bot": "Loftus",
            "alias": []
        },
        {
            "name": "Mandurah ARC",
            "top": "",
            "mid": "Mandurah",
            "bot": "ARC",
            "alias": []
        },
        {
            "name": "MBC",
            "top": "",
            "mid": "",
            "bot": "MBC",
            "alias": ["Mandurah Baptist College", "Mandurah Baptist Col"]
        },
        {
            "name": "Melville LeisureFit",
            "top": "",
            "mid": "Melville",
            "bot": "LeisureFit",
            "alias": ["Melville Leisure"]
        },
        {
            "name": "Methodist Ladies College",
            "top": "Methodist",
            "mid": "Ladies",
            "bot": "College",
            "alias": ["MLC", "Methodist L. Col"]
        },
        {
            "name": "Murdoch Active",
            "top": "",
            "mid": "Murdoch",
            "bot": "Active",
            "alias": []
        },
        {
            "name": "Penrhos College",
            "top": "",
            "mid": "Penrhos",
            "bot": "College",
            "alias": ["Penrhos"]
        },
        {
            "name": "Rossmoyne",
            "top": "",
            "mid": "",
            "bot": "Rossmoyne",
            "alias": ["Rossmoyne SHS"]
        },
        {
            "name": "Santa Maria",
            "top": "",
            "mid": "Santa",
            "bot": "Maria",
            "alias": ["Santa Maria College"]
        },
        {
            "name": "St Mary's",
            "top": "",
            "mid": "",
            "bot": "St Mary's",
            "alias": []
        },
        {
            "name": "The Rise",
            "top": "",
            "mid": "",
            "bot": "The Rise",
            "alias": []
        },
        {
            "name": "UWA Recreation Centre",
            "top": "UWA",
            "mid": "Recreation",
            "bot": "Centre",
            "alias": ["UWA", "UWA Rec. Centre", "UWA Rec Centre"]
        },
        {
            "name": "Wesley College",
            "top": "",
            "mid": "Wesley",
            "bot": "College",
            "alias": ["Wesley"]
        },
        {
            "name": "Warwick",
            "top": "",
            "mid": "",
            "bot": "Warwick",
            "alias": ["Warwick Stadium", "Warwick Stad."]
        }
    ],
    "wavl": [{
            "id": 103,
            "long": "State League Women",
            "short": "SL Women"
        },
        {
            "id": 102,
            "long": "State League Men",
            "short": "SL Men"
        },
        {
            "id": 104,
            "long": "State League Reserve Women",
            "short": "SLR Women"
        },
        {
            "id": 105,
            "long": "State League Reserve Men",
            "short": "SLR Men"
        },
        {
            "id": 107,
            "long": "Division 1 Women",
            "short": "Div 1 W"
        },
        {
            "id": 106,
            "long": "Division 1 Men",
            "short": "Div 1 M"
        },
        {
            "id": 109,
            "long": "Division 2 Women",
            "short": "Div 2 W"
        },
        {
            "id": 108,
            "long": "Division 2 Men",
            "short": "Div 2 M"
        },
        {
            "id": 111,
            "long": "Division 3 Women",
            "short": "Div 3 W"
        },
        {
            "id": 115,
            "long": "Division 3 Men",
            "short": "Div 3 M"
        },
        {
            "id": 129,
            "long": "Division 4 Men",
            "short": "Div 4 M"
        },
        {
            "id": 112,
            "long": "Division 4 Women",
            "short": "Div 4 W"
        },
        {
            "id": 130,
            "long": "Division 5 Men",
            "short": "Div 5 M"
        },
        {
            "id": 131,
            "long": "Division 6 Men",
            "short": "Div 6 M"
        }
    ],
    "jl": [{
            "id": 117,
            "long": "7/8 Female North",
            "short": "7/8 F N"
        },
        {
            "id": 118,
            "long": "7/8 Female South",
            "short": "7/8 F S"
        },
        {
            "id": 110,
            "long": "7/8 Male North",
            "short": "7/8 M N"
        },
        {
            "id": 116,
            "long": "7/8 Male South",
            "short": "7/8 M S"
        },
        {
            "id": 122,
            "long": "9/10 Female Pool 1",
            "short": "9/10 F 1"
        },
        {
            "id": 125,
            "long": "9/10 Female Pool 2",
            "short": "9/10 F 2"
        },
        {
            "id": 124,
            "long": "9/10 Female Pool 3",
            "short": "9/10 F 3"
        },
        {
            "id": 121,
            "long": "9/10 Male North",
            "short": "9/10 M N"
        },
        {
            "id": 119,
            "long": "9/10 Male South Pool 1",
            "short": "9/10 M S 1"
        },
        {
            "id": 120,
            "long": "9/10 Male South Pool 2",
            "short": "9/10 M S 2"
        },
        {
            "id": 128,
            "long": "11/12 Female",
            "short": "11/12 F"
        },
        {
            "id": 127,
            "long": "11/12 Male North",
            "short": "11/12 M N"
        },
        {
            "id": 126,
            "long": "11/12 Male South",
            "short": "11/12 M S"
        }
    ],
    "div": {
        80: ["W", "State League Women", "SL W"]
    }

}




function WAVL_MAIN() {
    // POST to python URL
    const url = '/WAVL/PUT';

    var token = generate_token();
    var force = document.getElementById("Checkbox99").checked;
    document.getElementById("Button4").value = "Please Wait";
    window.setInterval(dots)
    document.getElementById("Button4").style.backgroundColor = "gold"
    document.getElementById("Button4").style.color = "black";
    document.getElementById("Button4").disabled = true;

    //console.log(token)
    var xhttp;
    xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            //console.log(this.responseText);
            document.getElementById("Button4").value = "Downloading Scoresheets";
            document.getElementById("Button4").style.backgroundColor = "green";
            document.getElementById("Button4").style.color = "white";
            document.getElementById("Button4").style.fontSize = "20px";
            window.clearInterval(dots);
            download(token);
            document.getElementById("Button4").value = "Generate Scoresheets";
            document.getElementById("Button4").style.backgroundColor = "#3370B7";
            document.getElementById("Button4").disabled = false;
            //document.getElementById("Button1").disabled = false;
            //document.getElementById("Button1").setAttribute( "onClick", "javascript: download('"+this.responseText+"');" );
        } else if (this.readyState == 4 && this.status == 408) {
            console.log("timeout :(");
            document.getElementById("Button4").disabled = false;
            document.getElementById("Button4").value = "Request Timeout. Try again?";
            document.getElementById("Button4").style.color = "white";
            document.getElementById("Button4").style.backgroundColor = "red";
            document.getElementById("Button4").style.fontSize = "15px";
            window.clearInterval(dots);
        } else if (this.readyState == 4 && this.status != 200) {
            console.log("timeout :(");
            document.getElementById("Button4").disabled = false;
            document.getElementById("Button4").value = "Error code: " + this.status + ". Try again?";
            document.getElementById("Button4").style.color = "white";
            document.getElementById("Button4").style.backgroundColor = "red";
            document.getElementById("Button4").style.fontSize = "15px";
            window.clearInterval(dots);
        }
    };
    xhttp.open("GET", url, true);
    xhttp.setRequestHeader("Access-Control-Allow-Headers", "*");
    xhttp.setRequestHeader("TOKEN", token);
    xhttp.setRequestHeader("FORCE", force);
    xhttp.send();
    var dots = window.setInterval(function() {
        var wait = document.getElementById("Button4");
        console.log(wait.value)
        if (wait.value.length < 16)
            wait.value += ".";
        else if (wait.value.length < 17)
            wait.value = "Please Wait";
    }, 1000);
}

function select_all_venue(checked = true) {
    const cbs = document.querySelectorAll('input[name="Venues"]');
    cbs.forEach((cb) => {
        cb.checked = checked;
    });
    document.getElementById("Checkbox32").setAttribute("onClick", "javascript: deselect_all_venue();");

}

function deselect_all_venue(checked = false) {
    const cbs = document.querySelectorAll('input[name="Venues"]');
    cbs.forEach((cb) => {
        cb.checked = checked;
    });
    document.getElementById("Checkbox32").setAttribute("onClick", "javascript: select_all_venue();");
}

function select_all_wavl(checked = true) {
    const cbs = document.querySelectorAll('input[name="WAVL_teams"]');
    cbs.forEach((cb) => {
        cb.checked = checked;
    });
    document.getElementById("Checkbox33").setAttribute("onClick", "javascript: deselect_all_wavl();");

}

function deselect_all_wavl(checked = false) {
    const cbs = document.querySelectorAll('input[name="WAVL_teams"]');
    cbs.forEach((cb) => {
        cb.checked = checked;
    });
    document.getElementById("Checkbox33").setAttribute("onClick", "javascript: select_all_wavl();");
}

function select_all_wavjl(checked = true) {
    const cbs = document.querySelectorAll('input[name="WAVjL_teams"]');
    cbs.forEach((cb) => {
        cb.checked = checked;
    });
    document.getElementById("Checkbox34").setAttribute("onClick", "javascript: deselect_all_wavjl();");

}

function deselect_all_wavjl(checked = false) {
    const cbs = document.querySelectorAll('input[name="WAVjL_teams"]');
    cbs.forEach((cb) => {
        cb.checked = checked;
    });
    document.getElementById("Checkbox34").setAttribute("onClick", "javascript: select_all_wavjl();");
}

function enable_button() {
    document.getElementById("WAVL").disabled = false;
}

function token_download(token) {
    var url = '/WAVL/download/' + token
    // GET to python URL
    var a = document.createElement("a");
    document.body.appendChild(a);
    a.style = "display:none";
    a.href = url;
    a.download = "Scoresheets.pdf";
    a.click();
    a.remove();

    var xhttp = new XMLHttpRequest();
    xhttp.open('GET', url, true);
    xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            console.log("done")
            cleanup();
        }
    }
    xhttp.send();
}


function generate_token() {
    var date = $("#DatePicker2").datepicker("option", "dateFormat", "yy-mm-dd").val()
    var sep = "-"
    var venues = ""
    var wavl = ""
    var wavjl = ""

    document.getElementsByName("Venues").forEach((checkbox) => {
        if (document.getElementById(checkbox.id).checked) {
            venues = venues + "1";
        } else {
            venues = venues + "0";
        }
    });
    document.getElementsByName("WAVL_teams").forEach((checkbox) => {
        if (document.getElementById(checkbox.id).checked) {
            wavl = wavl + "1";
        } else {
            wavl = wavl + "0";
        }
    });
    document.getElementsByName("WAVjL_teams").forEach((checkbox) => {
        if (document.getElementById(checkbox.id).checked) {
            wavjl = wavjl + "1";
        } else {
            wavjl = wavjl + "0";
        }
    });
    var v_hex = parseInt(venues, 2).toString(16)
    var w_hex = parseInt(wavl, 2).toString(16)
    var j_hex = parseInt(wavjl, 2).toString(16)
    var v_len = venues.length
    var w_len = wavl.length
    var j_len = wavjl.length
    console.log(v_hex)
    console.log(w_hex)
    console.log(j_hex)
    var token = date + sep + v_hex + sep + v_len + sep + w_hex + sep + w_len + sep + j_hex + sep + j_len

    return token
}

function cleanup() {
    var url = '/cleanup'
    var xhttp = new XMLHttpRequest();
    xhttp.open('GET', url, true);
    xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {}
    }
    xhttp.send();
}




const DIVISIONS = {
    "State League Women": ["State League Women", "SL Women", "103"],
    "State League Men": ["State League Men", "SL Men", "102"],
    "State League Reserve Men": ["State League Reserve Men", "SLR Men", "104"],
    "State League Reserve Women": ["State League Reserve Women", "SLR Women", "105"],

    "Division 1 Men": ['Division 1 Men', 'Div 1 M', "106"],
    "Division 1 Women": ['Division 1 Women', 'Div 1 W', "107"],
    "Division 2 Men": ['Division 2 Men', 'Div 2 M', "108"],
    "Division 2 Women": ['Division 2 Women', 'Div 2 W', "109"],
    "Division 3 Men": ['Division 3 Men', 'Div 3 M', "115"],
    "Division 3 Women": ['Division 3 Women', 'Div 3 W', "111"],
    "Division 4 Men": ['Division 4 Men', 'Div 4 M', "129"],
    "Division 4 Women": ['Division 4 Women', 'Div 4 W', "112"],
    "Division 5 Men": ['Division 5 Men', 'Div 5 M', "130"],
    "Division 6 Men": ['Division 6 Men', 'Div 6 M', "131"],

    '7/8 Female North': ['7/8 Female North', '7/8 F N', '117'],
    '7/8 Female South': ['7/8 Female South', '7/8 F S', '118'],
    '9/10 Female Pool 1': ['9/10 Female Pool 1', '9/10 F 1', '122'],
    '9/10 Female Pool 2': ['9/10 Female Pool 2', '9/10 F 2', '125'],
    '9/10 Female Pool 3': ['9/10 Female Pool 3', '9/10 F 3', '124'],
    '11/12 Female': ['11/12 Female', '11/12 F', '128'],
    '11/12 Male North': ['11/12 Male North', '11/12 M N', '127'],
    '11/12 Male South': ['11/12 Male South', '11/12 M S', '126'],
    '9/10 Male North': ['9/10 Male North', '9/10 M N', '121'],
    '9/10 Male South Pool 1': ['9/10 Male South Pool 1', '9/10 M S 1', '119'],
    '9/10 Male South Pool 2': ['9/10 Male South Pool 2', '9/10 M S 2', '120'],
    '7/8 Male North': ['7/8 Male North', '7/8 M N', '110'],
    '7/8 Male South': ['7/8 Male South', '7/8 M S', '116'],

    'Year 7/8 Female North': ['7/8 Female North', '7/8 F N', '117'],
    'Year 7/8 Female South': ['7/8 Female South', '7/8 F S', '118'],
    'Year 9/10 Female Pool 1': ['9/10 Female Pool 1', '9/10 F 1', '122'],
    'Year 9/10 Female Pool 2': ['9/10 Female Pool 2', '9/10 F 2', '125'],
    'Year 9/10 Female Pool 3': ['9/10 Female Pool 3', '9/10 F 3', '124'],
    'Year 11/12 Female': ['11/12 Female', '11/12 F', '128'],
    'Year 11/12 Male North': ['11/12 Male North', '11/12 M N', '127'],
    'Year 11/12 Male South': ['11/12 Male South', '11/12 M S', '126'],
    'Year 9/10 Male North': ['9/10 Male North', '9/10 M N', '121'],
    'Year 9/10 Male South Pool 1': ['9/10 Male South Pool 1', '9/10 M S 1', '119'],
    'Year 9/10 Male South Pool 2': ['9/10 Male South Pool 2', '9/10 M S 2', '120'],
    'Year 7/8 Male North': ['7/8 Male North', '7/8 M N', '110'],
    'Year 7/8 Male South': ['7/8 Male South', '7/8 M S', '116'],
}


const VENUE_SPLIT = {
    "aquinas": "*Aquinas*College",
    "aquinas college": "*Aquinas*College",
    "ballajura": "**Ballajura",
    "ballajura indoor spo": "**Ballajura",
    "bendat": "**Bendat",
    "cockburn": "**Cockburn",
    "cockburn arc": "**Cockburn",
    "curtin stadium": "*Curtin*Stadium",
    "curtin": "*Curtin*Stadium",
    "ecu": "*ECU*Mt. Lawley",
    "ecu mt. lawley": "*ECU*Mt. Lawley",
    "ecu mt lawley": "*ECU*Mt. Lawley",
    "geographe leisure": "Geographe*Leisure*Centre",
    "geographe lei. centr": "Geographe*Leisure*Centre",
    "gold netball centre": "Gold*Netball*Centre",
    "greenwood college": "*Greenwood*College",
    "hale": "**Hale",
    "halls head rec centre": "Halls Head*Recreation*Centre",
    "halls head rec": "Halls Head*Recreation*Centre",
    "hbf stad. claremont": "*HBF*Stadium",
    "john wollaston": "*John*Wallaston",
    "john wollaston acs": "*John*Wallaston",
    "kingsway": "**Kingsway",
    "kingsway indoor stad": "**Kingsway",
    "loftus": "**Loftus",
    "mandurah arc": "*Mandurah*ARC",
    "mandurah baptist college": "**MBC",
    "mandurah baptist col": "**MBC",
    "mbc": "**MBC",
    "melville leisurefit": "*Melville*LeisureFit",
    "melville leisure": "*Melville*LeisureFit",
    "methodist ladies college": "Methodist*Ladies*College",
    "methodist l. col": "Methodist*Ladies*College",
    "mlc": "Methodist*Ladies*College",
    "murdoch active": "*Murdoch*Active",
    "penrhos college": "*Penrhos*College",
    "rossmoyne": "**Rossmoyne",
    "santa maria": "*Santa*Maria",
    "santa maria college": "*Santa*Maria",
    "st mary's": "**St Mary's",
    "the rise": "**The Rise",
    "uwa rec. centre": "UWA*Recreation*Centre",
    "uwa rec centre": "UWA*Recreation*Centre",
    "warwick": "**Warwick",
    "warwick stadium": "**Warwick",
    "warwick stad.": "**Warwick",
    "wesley college": "*Wesley*College"
}




class Fixture {
    constructor(venue, venue_0, venue_1, venue_2, venue_full, court, team_a, team_b, duty, division, date_dd, date_mm,
        date_yyyy, time_hr, time_min, sorting, time_sorting) {
        self.venue = venue
        self.venue_0 = venue_0
        self.venue_1 = venue_1
        self.venue_2 = venue_2
        self.venue_full = venue_full
        self.court = court
        self.team_a = team_a
        self.team_b = team_b
        self.duty = duty
        self.division = division
        self.date_dd = date_dd
        self.date_mm = date_mm
        self.date_yyyy = date_yyyy
        self.time_hr = time_hr
        self.time_min = time_min
        self.sorting = sorting
        self.time_sorting = time_sorting;
    }

    get venue() {
        return self.venue
    }
    get venue_0() {
        return self.venue_0
    }
    get venue_1() {
        return self.venue_1
    }
    get venue_2() {
        return self.venue_2
    }
    get venue_full() {
        return self.venue_full
    }
    get court() {
        return self.court
    }
    get team_a() {
        return self.team_a
    }
    get team_b() {
        return self.team_b
    }
    get duty() {
        return self.duty
    }
    get division() {
        return self.division
    }
    get date_dd() {
        return self.date_dd
    }
    get date_mm() {
        return self.date_mm
    }
    get date_yyyy() {
        return self.date_yyyy
    }
    get time_hr() {
        return self.time_hr
    }
    get time_min() {
        return self.time_min
    }
    get sorting() {
        return self.sorting
    }
    get time_sorting() {
        return self.time_sorting
    }
}




var dots = window.setInterval(function() {
    var wait = document.getElementById("Button4");
    console.log(wait.value)
    if (wait.value.length < 16)
        wait.value += ".";
    else if (wait.value.length < 17)
        wait.value = "Please Wait";
}, 1000);




function WAVL_ONLINE() {
    var venues = []
    var wavjl = []
    var wavl = []
    var date = $("#DatePicker2").datepicker("option", "dateFormat", "yy-mm-dd").val()
    document.getElementsByName("Venues").forEach((checkbox) => {
        if (document.getElementById(checkbox.id).checked) {
            venues.push(document.getElementById(checkbox.id).title)
        }
    })
    document.getElementsByName("WAVL_teams").forEach((checkbox) => {
        if (document.getElementById(checkbox.id).checked) {
            wavjl.push(document.getElementById(checkbox.id).title)
        }
    })
    document.getElementsByName("WAVjL_teams").forEach((checkbox) => {
        if (document.getElementById(checkbox.id).checked) {
            wavl.push(document.getElementById(checkbox.id).title)
        }
    })



    document.getElementById("Button4").value = "Please Wait";
    window.setInterval(dots)
    document.getElementById("Button4").style.backgroundColor = "gold";
    document.getElementById("Button4").style.color = "black";
    document.getElementById("Button4").disabled = true;

    pdf_init(venues, wavl, wavjl, date)
    //document.getElementById("Button1").disabled = false;
    //document.getElementById("Button1").setAttribute( "onClick", "javascript: download('"+this.responseText+"');" );

    //pdf_init(venues, wavl, wavjl, date)
}

function pdf_init(venues, wavl, wavjl, date) {
    var concatted = wavl.concat(wavjl)
    var leagues = []
    console.log(concatted)
    console.log("*")
    for (var i = 0; i < concatted.length; i++) {
        leagues.push(DIVISIONS[concatted[i]])
    }
    console.log("*")
    console.log(leagues)

    var fixtures = []
    //modifyPdf(fixtures[0]).then(value => {mix.push(value)})
    //modifyPdf(fixtures[1]).then(value => {mix.push(value)})
    if (document.getElementById("Checkbox99").checked) {
        console.log(date);
        for (var j = 0; j < 6; j++) {
          var date_time = $("#DatePicker2").datepicker("getDate");
          date_time.setDate(date_time.getDate() - j;
          console.log(date_time);
          for (var i = 0; i < leagues.length; i++) {
            var indiv = get_single_fixture(venues, leagues[i], date_time);
            console.log(indiv);
            fixtures.push(indiv);
        }
        }
    } else {
        for (var i = 0; i < leagues.length; i++) {
            var indiv = get_single_fixture(venues, leagues[i], date);
            console.log(indiv);
            fixtures.push(indiv);
        }
    }

    //Promise.all(get_fixtures(venues, leagues, date)).then(fix_val => {
    Promise.all(fixtures).then(fix_val => {
        modifyPdf(fix_val, venues, leagues, date).then(value => {
            Promise.all(value).then(value_3 => {
                mergePDFDocuments(value_3).then(value_2 => {
                    console.log(value_2);
                    let filename = "Scoresheets " + date.toString() + ".pdf"
                    download(value_2, filename, "application/pdf");
                    window.clearInterval(dots);
                    document.getElementById("Button4").value = "Generate Scoresheets";
                    document.getElementById("Button4").style.backgroundColor = "#3370B7";
                    document.getElementById("Button4").style.color = "#FFFFFF"
                    document.getElementById("Button4").disabled = false;
                })
            })
        })
    })
    //download(res, "pdf-lib_creation_example.pdf", "application/pdf");

    //var existing = gen_PDF(fixtures)

    //console.log(existing)
    //var merged = merge_PDF(existing)
    //download(existing, "pdf-lib_modification_example.pdf", "application/pdf");
}


async function get_single_fixture(venues, division, date) {
    const {
        PDFDocument,
        StandardFonts,
        rgb
    } = PDFLib;
    axios;
    const head = 'https://calm-sea-71189.herokuapp.com/vwa.bracketpal.com/dailyform/';

    var url = head + division[2] + "/" + date.toString();
    return await axios.get(url)
}

function sorting(a, b) {
    if (a[15] === b[15]) {
        return 0;
    } else {
        return (a[15] < b[15]) ? -1 : 1;
    }
}

function time_sorting(a, b) {
    if (a[16] === b[16]) {
        return 0;
    } else {
        return (a[16] < b[16]) ? -1 : 1;
    }
}

// [zero_venue_split, _venue_0, _venue_1, _venue_2, _venue_full, _court, _team_a, _team_b, _duty, _division, _date_dd, _date_mm, _date_yyyy, _time_hr, _time_min, _sorting, _time_sorting]
// [     0              1          2          3          4         5        6         7     8         9        10         11         12        13          14       15          16
async function modifyPdf(fix, venues, leagues, dates) {
    console.log(venues);
    console.log(leagues);
    var fixtures = html_to_fixture(venues, leagues, dates, fix)
    console.log(fixtures)
    fixtures.sort(sorting);
    console.log(fixtures);
    const {
        PDFDocument,
        StandardFonts,
        rgb
    } = PDFLib;
    var total = new Array(fixtures.length);
    console.log(fixtures)
    for (var i = 0; i < fixtures.length; i++) {
        //var WAVLurl = "./static/def.pdf";
        var WAVLurl = "./static/def.pdf"
        var JLurl = "./static/def_jl.pdf";

        var WAVLexistingPdfBytes = await fetch(WAVLurl).then(res => res.arrayBuffer())

        var WAVLpdfDoc = await PDFLib.PDFDocument.load(WAVLexistingPdfBytes)
        var WAVLhelveticaFont = await WAVLpdfDoc.embedFont(PDFLib.StandardFonts.Helvetica)
        var WAVLhelveticaBold = await WAVLpdfDoc.embedFont(PDFLib.StandardFonts.HelveticaBold)
        var WAVLpages = await WAVLpdfDoc.getPages()
        var WAVLfirstPage = await WAVLpages[0]

        var JLexistingPdfBytes = await fetch(JLurl).then(resp => resp.arrayBuffer())

        var JLpdfDoc = await PDFLib.PDFDocument.load(JLexistingPdfBytes)
        var JLhelveticaFont = await JLpdfDoc.embedFont(PDFLib.StandardFonts.Helvetica)
        var JLhelveticaBold = await JLpdfDoc.embedFont(PDFLib.StandardFonts.HelveticaBold)
        var JLpages = await JLpdfDoc.getPages()
        var JLfirstPage = await JLpages[0]

        if (fixtures[i][9][0][0] == "D" || fixtures[i][9][0][0] == "S") {
            await WAVLfirstPage.drawText(fixtures[i][1], {
                x: parseInt((310 - measureText(fixtures[i][1], 10)).toString()),
                y: 575,
                size: 10,
                font: WAVLhelveticaFont
            })
            await WAVLfirstPage.drawText(fixtures[i][2], {
                x: parseInt((310 - measureText(fixtures[i][2], 10)).toString()),
                y: 566,
                size: 10,
                font: WAVLhelveticaFont
            })
            await WAVLfirstPage.drawText(fixtures[i][3], {
                x: parseInt((310 - measureText(fixtures[i][3], 10)).toString()),
                y: 557,
                size: 10,
                font: WAVLhelveticaFont
            })
            try {
                // court
                await WAVLfirstPage.drawText(fixtures[i][5], {
                    x: parseInt((400 - measureBold(fixtures[i][5], 13).toString()).toString()),
                    y: 557,
                    size: 13,
                    font: WAVLhelveticaBold
                })
            } catch (e) {
                console.log(e);
            }
            try {
                var hour = " ";
                if (fixtures[i][13].toString().toLowerCase().substring(0, 3) != "tbc") {
                    if (parseInt(fixtures[i][13]).toString().length == 1) {
                        hour = " " + parseInt(fixtures[i][13]).toString()
                    } else {
                        hour = parseInt(fixtures[i][13]).toString()
                    }
                    await WAVLfirstPage.drawText(hour, {
                        x: parseInt((492 - measureBold(hour, 13) - measureBold(hour, 13)).toString()),
                        y: 557,
                        size: 13,
                        font: WAVLhelveticaBold
                    })
                    await WAVLfirstPage.drawText(fixtures[i][14], {
                        x: 500,
                        y: 557,
                        size: 13,
                        font: WAVLhelveticaBold
                    })
                }
            } catch (e) {
                console.log(e);
            }
            // catch - continue
            var dd = " ";
            if (parseInt(fixtures[i][10]).toString().length == 1) {
                dd = " " + parseInt(fixtures[i][10]).toString()
            } else {
                dd = parseInt(fixtures[i][10]).toString()
            }

            await WAVLfirstPage.drawText(dd, {
                x: parseInt((596 - measureBold(dd, 13) - measureBold(dd, 13)).toString()),
                y: 557,
                size: 13,
                font: WAVLhelveticaBold
            })
            await WAVLfirstPage.drawText(parseInt(fixtures[i][11]).toString(), {
                x: parseInt((613 - measureBold(fixtures[i][11], 13)).toString()),
                y: 557,
                size: 13,
                font: WAVLhelveticaBold
            })
            await WAVLfirstPage.drawText(fixtures[i][12].slice(2, 4), {
                x: 625,
                y: 557,
                size: 13,
                font: WAVLhelveticaBold
            })
            await WAVLfirstPage.drawText(fixtures[i][9][1], {
                x: parseInt((773 - measureBold(fixtures[i][9][1], 13)).toString()),
                y: 557.5,
                size: 13,
                font: WAVLhelveticaBold
            })
            await WAVLfirstPage.drawText(fixtures[i][8], {
                x: parseInt((710 - measureText(fixtures[i][8], 14)).toString()),
                y: 528,
                size: 14,
                font: WAVLhelveticaFont
            })
            // if length > 18
            if (fixtures[i][6].length > 18 || fixtures[i][7].length > 18) {
                await WAVLfirstPage.drawText(fixtures[i][6], {
                    x: parseInt((320 - measureText(fixtures[i][6], 10)).toString()),
                    y: 527,
                    size: 10,
                    font: WAVLhelveticaFont
                })
                await WAVLfirstPage.drawText(fixtures[i][7], {
                    x: parseInt((460 - measureText(fixtures[i][7], 10)).toString()),
                    y: 527,
                    size: 10,
                    font: WAVLhelveticaFont
                })
            } else {
                WAVLpdfDoc.TextAlignment = 1;
                await WAVLfirstPage.drawText(fixtures[i][6], {
                    x: parseInt((320 - measureText(fixtures[i][6], 14)).toString()),
                    y: 527,
                    size: 14,
                    font: WAVLhelveticaFont
                })
                await WAVLfirstPage.drawText(fixtures[i][7], {
                    x: parseInt((460 - measureText(fixtures[i][7], 14)).toString()),
                    y: 527,
                    size: 14,
                    font: WAVLhelveticaFont
                })
            }
            var saved = await WAVLpdfDoc.saveAsBase64();
        } else {
            // Junior League
            // full venue
            await JLfirstPage.drawText(fixtures[i][0], {
                x: parseInt((180 - measureText(fixtures[i][0], 13)).toString()),
                y: 504,
                size: 13,
                font: JLhelveticaFont
            })
            // court
            await JLfirstPage.drawText(fixtures[i][5], {
                x: parseInt((562 - measureText(fixtures[i][5], 13)).toString()),
                y: 504,
                size: 13,
                font: JLhelveticaFont
            })
            try {
                // time
                let time = " "
                if (parseInt(fixtures[i][13]).toString().length == 1) {
                    time = " " + parseInt(fixtures[i][13]).toString() + ":" + fixtures[1][14];
                } else {
                    time = parseInt(fixtures[i][13]).toString() + ":" + fixtures[1][14];
                }
                await JLfirstPage.drawText(time, {
                    x: 442,
                    y: 504,
                    size: 13,
                    font: JLhelveticaFont
                })
            } catch (e) {
                console.log(e)
            }
            try {
                // date
                let dt = " ";
                dt = parseInt(fixtures[i][10]).toString() + "/" + parseInt(fixtures[i][11]).toString() + "/" + fixtures[i][12]
                await JLfirstPage.drawText(dt, {
                    x: 315,
                    y: 504,
                    size: 13,
                    font: JLhelveticaFont
                })
            } catch (e) {
                console.log(e)
            }
            // division
            await JLfirstPage.drawText(fixtures[i][9][0], {
                x: parseInt((720 - measureText(fixtures[i][9][0], 13)).toString()),
                y: 504,
                size: 13,
                font: JLhelveticaFont
            })
            // if length > 25
            if (fixtures[i][6].length > 25 || fixtures[i][7].length > 25) {
                await JLfirstPage.drawText(fixtures[i][6], {
                    x: parseInt((250 - measureText(fixtures[i][6], 10)).toString()),
                    y: 472,
                    size: 10,
                    font: JLhelveticaFont
                })
                await JLfirstPage.drawText(fixtures[i][7], {
                    x: parseInt((660 - measureText(fixtures[i][7], 10)).toString()),
                    y: 472,
                    size: 10,
                    font: JLhelveticaFont
                })
            } else {
                JLpdfDoc.TextAlignment = 1;
                await JLfirstPage.drawText(fixtures[i][6], {
                    x: parseInt((250 - measureText(fixtures[i][6], 14)).toString()),
                    y: 472,
                    size: 14,
                    font: JLhelveticaFont
                })
                await JLfirstPage.drawText(fixtures[i][7], {
                    x: parseInt((660 - measureText(fixtures[i][7], 14)).toString()),
                    y: 472,
                    size: 14,
                    font: JLhelveticaFont
                })
            }
            var saved = await JLpdfDoc.saveAsBase64();
        }
        total[i] = saved;
    }
    console.log("End of modifyPdf");
    console.log(document.getElementById("Checkbox99").checked);
    if (document.getElementById("Checkbox99").checked) {
        var csv = [
            ["WAVL 2022", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
            ["Date", "Venue", "Time", "Div", "Court", "Team A", "Team B", "Duty Team", "Time", "Sets", "Referee 1st", "Qualifications", "Referee 2nd", "Qualifications", "Assessor"]
        ];
        fixtures.sort(time_sorting);
        for (var i = 0; i < fixtures.length; i++) {
            let date = fixtures[i][10] + "/" + fixtures[i][11] + "/" + fixtures[i][12];
            let full_time = fixtures[i][13] + ":" + fixtures[i][14];
            let crt = fixtures[i][5];
            if (!(crt)) {
                crt = "";
            } else {
                crt = crt.trim();
            }
            csv.push([date, fixtures[i][4], full_time, fixtures[i][9][1], crt, fixtures[i][6], fixtures[i][7], fixtures[i][8], "", "", "", "", "", "", ""]);
        }
        console.log("fixtures x2");
        //download(pdfBytes, "pdf-lib_creation_example.pdf", "application/pdf");
        try {
            console.log(csv);
            let csvContent = "data:text/csv;charset=utf-8," + csv.map(e => e.join(",")).join("\n");
            var encodedUri = encodeURI(csvContent);
            var link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            let filename = "Runsheet" + dates + ".csv";
            link.setAttribute("download", filename);
            document.body.appendChild(link); // Required for FF

            link.click();
        } catch (e) {
            console.log(e)
        }
    }
    console.log(total);
    console.log("???");
    return await total;

}

async function mergePDFDocuments(documents) {
    console.log(documents);
    var mergedPdf = await PDFLib.PDFDocument.create();
    for (var i = 0; i < documents.length; i++) {
        console.log(i)
        var docone = await PDFLib.PDFDocument.load(await documents[i]);
        //var copiedPagesone = await mergedPdf.copyPages(docone, [0, 1]);
        //await mergedPdf.addPage(await copiedPagesone[0]);
        //await mergedPdf.addPage(await copiedPagesone[1]);
        var copiedPagesone = await mergedPdf.copyPages(docone, docone.getPageIndices());
        for (var j = 0; j < docone.getPageIndices().length; j++) {
            mergedPdf.addPage(await copiedPagesone[j]);
        }
    }
    var saved = await mergedPdf.save();

    return await saved;

    //download(await mergedPdf, "pdf-lib_creation_example.pdf", "application/pdf");
}

async function merge_PDF(existing) {
    const mergedPdf = await PDFLib.PDFDocument.create();
    console.log(await existing)
    for (var i = 0; i < await existing.length; i++) {
        var doc = await PDFLib.PDFDocument.load(await existing[1]);
        var copiedPages = await mergedPdf.copyPages(doc, doc.getPageIndices());
        copiedPages.forEach((page) => mergedPdf.addPage(page));
    }

    return await mergedPdf.save();
}


function get_URLS(leagues, date) {
    var all_urls = []
    for (var i = 0; i < leagues.length; i++) {
        var url = head + leagues[k][2] + "/" + date.toString();
        all_urls.push(url)
    }
    return all_urls
}

function div_from_id(id) {
    for (var i = 0; i < __CONFIG__.wavl.length; i++) {
        if (__CONFIG__.wavl[i].id == id) {
            return [__CONFIG__.wavl[i].long, __CONFIG__.wavl[i].short, __CONFIG__.wavl[i].id]
        }
    }
    for (var i = 0; i < __CONFIG__.jl.length; i++) {
        if (__CONFIG__.jl[i].id == id) {
            return [__CONFIG__.jl[i].long, __CONFIG__.jl[i].short, __CONFIG__.jl[i].id]
        }
    }
    return false
}

function add_aliases(venues) {
    var resultant = [];
    var low_venues = [];
    for (var j = 0; j < venues.length; j++) {
        low_venues.push(venues[j].toLowerCase())
    }

    console.log(low_venues)
    for (var i = 0; i < __CONFIG__.venues.length; i++) {
        console.log(__CONFIG__.venues[i].name.toLowerCase())
        if (low_venues.includes(__CONFIG__.venues[i].name.toLowerCase())) {
            resultant.push(__CONFIG__.venues[i].name);
            for (var k = 0; k < __CONFIG__.venues[i].alias.length; k++) {
                var _alias = __CONFIG__.venues[i].alias[k];
                resultant.push(_alias)
            }
        }
    }
    return resultant;
}

function html_to_fixture(venues, leagues, date, all_html) {
    let fixtures_list = []
    console.log(leagues);
    console.log(all_html);
    let venue_usage = add_aliases(venues);
    console.log(venue_usage)
    console.log("HERE HERE HERE")
    for (let x = 0; x < all_html.length; x++) {
        let parser = new DOMParser();
        let htmlDoc = parser.parseFromString(all_html[x].data, 'text/html');
        console.log(all_html[x].request.responseURL)
        try {
            let div_table = htmlDoc.getElementsByTagName("table")[1]
            console.log("***")
            console.log(div_table.rows.item(1).cells.item(2).innerText)
            let temp_div = DIVISIONS[div_table.rows.item(1).cells.item(2).innerText]
            console.log(temp_div)
            let table = htmlDoc.getElementsByTagName("table")[2]
            let rowLength = table.rows.length;
            for (let i = 1; i < rowLength; i++) {
                let cells = table.rows.item(i).cells;
                let venue = cells.item(1).innerText;
                console.log(venue);
                let venue_split = venue.split(" Ct")
                let zero_venue_split = venue_split[0].replaceAll(" Ct", "");
                console.log(venue_usage);
                console.log(zero_venue_split);
                if (venue_usage.includes(zero_venue_split)) {
                    let _court = "";
                    try {
                        _court = cells.item(1).innerText.split("Ct")[1];
                    } catch (e) {
                        _court = "";
                    }
                    if (_court == null) {
                        _court = "";
                    }
                    console.log(_court);
                    const _team_a = cells.item(2).innerText;
                    const _team_b = cells.item(5).innerText;
                    console.log(_team_a);
                    console.log(x)
                    let _duty = " ";
                    let _time_hr = " ";
                    let _time_min = " ";
                    try {
                        _duty = cells.item(7).innerText.slice(5);
                    } catch (e) {
                        console.log(e)
                        _duty = " ";
                    }
                    //var division = leagues[j];
                    let url = all_html[x].request.responseURL;
                    let split_url = url.split('/');
                    let _division = temp_div;
                    //console.log(temp_div)
                    //let _division = __CONFIG__
                    //console.log(_division)
                    let _date = date.split('-');
                    let _date_dd = _date[2];
                    let _date_mm = _date[1];
                    let _date_yyyy = _date[0]
                    try {
                        let time = cells.item(0).innerText.split(":")
                        _time_hr = time[0].padStart(2, "0");
                        _time_min = time[1];
                    } catch (e) {
                        console.log(e);
                        _time_hr = " ";
                        _time_min = " ";
                    }
                    let _tmp_venue = VENUE_SPLIT[zero_venue_split.toLowerCase()].split("*");
                    const _venue_0 = _tmp_venue[0]
                    const _venue_1 = _tmp_venue[1]
                    const _venue_2 = _tmp_venue[2]
                    let _venue_full = VENUE_SPLIT[zero_venue_split.toLowerCase()].replaceAll("*", " ").trimLeft();
                    let _sorting = _venue_full + " " + _court + " " + _time_hr
                    let _time_sorting = _venue_full + " " + _time_hr + " " + _court;
                    /*fix['venue'] = zero_venue_split;
                      fix['venue_0'] = _venue_0
                      fix['venue_1'] = _venue_1
                      fix['venue_2'] = _venue_2
                      fix['venue_full'] = _venue_full
                      fix['court'] = _court
                      fix['team_a'] = _team_a
                      fix['team_b'] = _team_b
                      fix['duty'] = _duty
                      fix['division'] = _division
                      fix['date_dd'] = _date_dd
                      fix['date_mm'] = _date_mm
                      fix['date_yyyy'] = _date_yyyy
                      fix['time_hr'] = _time_hr
                      fix['time_min'] = _time_min
                      fix['sorting'] = _sorting
  */
                    //console.log(zero_venue_split)
                    //console.log(_venue_0)
                    //console.log(_venue_1)
                    //console.log(_venue_2)
                    //console.log(_team_a)
                    //console.log(_team_b)
                    //console.log(_duty)

                    //const fix = new Fixture(zero_venue_split, _venue_0, _venue_1, _venue_2, _venue_full, _court,
                    //    _team_a, _team_b, _duty, _division, _date_dd, _date_mm, _date_yyyy, _time_hr, _time_min, _sorting)
                    //console.log(fix)
                    fixtures_list.push([zero_venue_split, _venue_0, _venue_1, _venue_2, _venue_full, _court,
                        _team_a, _team_b, _duty, _division, _date_dd, _date_mm, _date_yyyy, _time_hr, _time_min, _sorting, _time_sorting
                    ])
                    //console.log(fixtures_list)

                } else {
                    /*
                    try{
                      if(cells.item(3).innerText != "BYE") {
                          console.log("UNUSED VENUE\n***")
                          console.log(zero_venue_split)
                          console.log("***")
                      }
                    } catch (e) {console.log(e); console.log(zero_venue_split);}*/
                    try {
                        if (Number.isInteger(parseInt(zero_venue_split.substring(0, 2).trim()))) {
                            console.log("BYE: " + zero_venue_split);
                        } else {
                            console.log("UNUSED VENUE\n***")
                            console.log(zero_venue_split)
                            console.log("***")
                        }
                    } catch (e) {
                        console.log("UNUSED VENUE\n***")
                        console.log(zero_venue_split)
                        console.log("***")
                    }

                }
            }
        } catch (e) {
            console.log(e)
        }
    }
    console.log(fixtures_list);
    return fixtures_list
}

function measureText(string, fontSize = 10) {
    const widths = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.1546875, 0.278125, 0.4, 0.721875, 0.5609375, 0.9609375, 0.7203125, 0.240625, 0.4, 0.4, 0.48125, 0.640625, 0.278125, 0.4, 0.278125, 0.4015625, 0.5609375, 0.55625, 0.5609375, 0.5609375, 0.640625, 0.5609375, 0.5609375, 0.5609375, 0.5609375, 0.5609375, 0.278125, 0.278125, 0.640625, 0.640625, 0.640625, 0.5609375, 1.1203125, 0.88125, 0.7203125, 0.8, 0.7234375, 0.7203125, 0.640625, 0.8, 0.7234375, 0.278125, 0.5, 0.8, 0.640625, 0.88125, 0.7234375, 0.8, 0.7203125, 0.8, 0.8, 0.7203125, 0.640625, 0.7234375, 0.8015625, 1.121875, 0.8015625, 0.8015625, 0.721875, 0.3203125, 0.48125, 0.3203125, 0.48125, 0.721875, 0.334375, 0.5609375, 0.640625, 0.5609375, 0.5609375, 0.5609375, 0.48125, 0.5609375, 0.5609375, 0.240625, 0.321875, 0.5609375, 0.240625, 0.88125, 0.5609375, 0.5609375, 0.640625, 0.5609375, 0.4, 0.5609375, 0.4015625, 0.5609375, 0.6421875, 0.88125, 0.6421875, 0.6421875, 0.6421875, 0.4, 0.2609375, 0.48125, 0.640625]
    const avg = 0.5823026315789476
    try {
        var tmp = string
            .split('')
            .map(c => c.charCodeAt(0) < widths.length ? widths[c.charCodeAt(0)] : avg)
            .reduce((cur, acc) => acc + cur) * fontSize
        return tmp / 2;
    } catch {
        return 0
    }
}

function measureBold(string, fontSize = 10) {
    const widths = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.1265625, 0.334375, 0.409375, 0.6421875, 0.5609375, 0.88125, 0.8, 0.18125, 0.4, 0.4, 0.5, 0.721875, 0.25, 0.4, 0.25, 0.4015625, 0.5609375, 0.5, 0.5609375, 0.5, 0.5609375, 0.5, 0.5609375, 0.5609375, 0.5609375, 0.5609375, 0.278125, 0.3203125, 0.721875, 0.721875, 0.721875, 0.48125, 0.9609375, 0.88125, 0.8015625, 0.7203125, 0.88125, 0.721875, 0.721875, 0.8, 0.88125, 0.4, 0.5625, 0.88125, 0.721875, 1.0421875, 0.88125, 0.8, 0.721875, 0.8, 0.88125, 0.5609375, 0.640625, 0.88125, 0.88125, 1.040625, 0.88125, 0.8, 0.8015625, 0.4, 0.4015625, 0.334375, 0.6421875, 0.6421875, 0.334375, 0.5609375, 0.6421875, 0.48125, 0.5609375, 0.48125, 0.5609375, 0.5609375, 0.6421875, 0.3203125, 0.4390625, 0.6421875, 0.3203125, 0.9625, 0.6421875, 0.5609375, 0.6421875, 0.5609375, 0.48125, 0.4, 0.4015625, 0.6421875, 0.6421875, 0.88125, 0.6421875, 0.6421875, 0.5625, 0.48125, 0.2015625, 0.48125, 0.721875]
    const avg = 0.5999835526315791
    try {
        var tmp = string
            .split('')
            .map(c => c.charCodeAt(0) < widths.length ? widths[c.charCodeAt(0)] : avg)
            .reduce((cur, acc) => acc + cur) * fontSize
        return tmp / 2;
    } catch {
        return 0
    }
}

function generate_Table() {
    var venue_list = [];
    var wavl_list = [];
    var jl_list = [];

    var table = document.getElementById("Table1")

    //console.log(__CONFIG__.venues.length)
    //console.log(__CONFIG__.wavl.length)
    //console.log(__CONFIG__.jl.length)
    //console.log(__CONFIG__.jl[3].name)
    for (var i = 0; i < Math.max(__CONFIG__.venues.length, __CONFIG__.wavl.length, __CONFIG__.jl.length); i++) {
        var row = table.insertRow(-1);
        var cell0 = row.insertCell(0);
        var cell1 = row.insertCell(1);
        var cell2 = row.insertCell(2);
        var cell3 = row.insertCell(3);
        var cell4 = row.insertCell(4);
        var cell5 = row.insertCell(5);
        var cell6 = row.insertCell(6);
        var cell7 = row.insertCell(7);
        var cell8 = row.insertCell(8);
        var cell9 = row.insertCell(9);

        // venue
        cell0.classList.add("cell12");
        cell0.innerHTML = '<p style="font-size:8px;line-height:9.5px;">&nbsp;</p>'

        try {
            var venue = __CONFIG__.venues[i];
            cell1.classList.add("cell2")
            cell1.innerHTML = '<div id="venue_' + i.toString() + '" style="display:inline-block;width:16px;height:20px;z-index:56;">' +
                '<input type="checkbox" id="checkvenue_' + i.toString() + '" name="Venues" value="on" checked="" style="display:inline-block;opacity:0;" title="' + venue.name + '">' +
                '<label for="checkvenue_' + i.toString() + '"></label>' +
                '</div>'

            cell2.classList.add("cell9")
            cell2.innerHTML = '<div id="wb_Text8">' +
                '<span style="color:#000000;font-family:Arial;font-size:16px;">' + venue.name + '</span>' +
                '</div>'
        } catch (e) {
            //console.log(e)
            cell1.classList.add("cell10")
            cell1.innerHTML = '<p style="font-size:8px;line-height:9.5px;">&nbsp;</p>'
            cell2.classList.add("cell11")
            cell2.innerHTML = '<p style="font-size:8px;line-height:9.5px;">&nbsp;</p>'
        }

        cell3.classList.add("cell1")
        cell3.innerHTML = '<p style="font-size:8px;line-height:9.5px;">&nbsp;</p>'

        try {
            var wavl = __CONFIG__.wavl[i];
            cell4.classList.add("cell2")
            cell4.innerHTML = '<div id="wavl_' + i.toString() + '" style="display:inline-block;width:16px;height:20px;z-index:58;">' +
                '<input type="checkbox" id="checkwavl_' + i.toString() + '" name="WAVL_teams" value="on" checked="" style="display:inline-block;opacity:0;" title="' + wavl.long + '">' +
                '<label for="checkwavl_' + i.toString() + '"></label>' +
                '</div>'

            cell5.classList.add("cell9")
            cell5.innerHTML = '<div id="wb_Text32">' +
                '<span style="color:#000000;font-family:Arial;font-size:16px;">' + wavl.long + '</span>' +
                '</div>'
        } catch (e) {
            //console.log(e)
            //console.log(i)
            cell4.classList.add("cell10")
            cell4.innerHTML = '<p style="font-size:8px;line-height:9.5px;">&nbsp;</p>'
            cell5.classList.add("cell11")
            cell5.innerHTML = '<p style="font-size:8px;line-height:9.5px;">&nbsp;</p>'
        }

        cell6.classList.add("cell1")
        cell6.innerHTML = '<p style="font-size:8px;line-height:9.5px;">&nbsp;</p>'

        try {
            var jl = __CONFIG__.jl[i]
            cell7.classList.add("cell2")
            cell7.innerHTML = '<div id="wavjl_' + i.toString() + '" style="display:inline-block;width:16px;height:20px;z-index:60;">' +
                '<input type="checkbox" id="checkwavjl_' + i.toString() + '" name="WAVjL_teams" value="on" checked="" style="display:inline-block;opacity:0;" title="' + jl.long + '">' +
                '<label for="checkwavjl_' + i.toString() + '"></label>' +
                '</div>'

            cell8.classList.add("cell9")
            cell8.innerHTML = '<div id="wb_Text49">' +
                '<span style="color:#000000;font-family:Arial;font-size:16px;">' + jl.long + '</span>' +
                '</div>'
        } catch (e) {
            //console.log(e)
            //console.log(i)
            cell7.classList.add("cell10")
            cell7.innerHTML = '<p style="font-size:8px;line-height:9.5px;">&nbsp;</p>'
            cell8.classList.add("cell11")
            cell8.innerHTML = '<p style="font-size:8px;line-height:9.5px;">&nbsp;</p>'

        }
    }
    var fin_row = table.insertRow(-1);
    var fin_cell = fin_row.insertCell(0);
    fin_cell.classList.add("cell99")
}

generate_Table()
